schema
  @auth(
    providers: [
      {
        type: oidc
        issuer: "https://accounts.google.com"
        clientId: "{{ env.GOOGLE_CLIENT_ID }}"
      }
    ]
    rules: [{ allow: owner }]
  ) {
  query: Query
}

extend type Mutation {
  checkout(input: CheckoutInput!): CheckoutSession! @resolver(name: "checkout")
}

input CheckoutInput {
  lineItems: [CheckoutLineItem]
}

input CheckoutLineItem {
  price: String!
  quantity: Int = 1
}

type CheckoutSession {
  url: String!
}

# TODO: not used yet, use it for user profile pages
# to show public todos of users
type User @model {
  username: String! @unique # set by a user, this will be a route to show public todos
  freeAiSuggestionsLimit: Int! @default(value: 5) # how many times user can use AI suggestions for free
  gpt3MonthlyTokensUsed: Int # how many gpt-3 tokens user used this month (for billing)
  gpt4MonthlyTokensUsed: Int # how many gpt-4 tokens user used this month (for billing)
}

type Todo @model {
  title: String!
  done: Boolean! @default(value: false)
  starred: Boolean! @default(value: false)
  priority: Int! @default(value: 0)
  note: String
  dueDate: String
  subtasks: [Subtask]
  cached: String # 'gpt-3' | 'gpt-4'
}

type Subtask @model {
  title: String!
  done: Boolean! @default(value: false)
  starred: Boolean! @default(value: false)
  priority: Int! @default(value: 0)
  note: String
  dueDate: String
  cached: String # 'gpt-3' | 'gpt-4'
}

type Settings @model {
  hideActionBar: Boolean! @default(value: false)
  iconOnlySidebar: Boolean! @default(value: false)
  openAiGptModel: String! @default(value: "gpt-3") # gpt-3 | gpt-4 | llama
}
